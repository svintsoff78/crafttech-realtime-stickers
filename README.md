# Crafttech

### Суть

Разработка платформы для совместной работы на виртуальных досках

### Задание

Создать минимальный, но хорошо-структурированный прототип модуля «Стикеры»,
который:

1. Обеспечивает CRUD-операции через REST-API. (смотреть следующий пункт)
2. Рассылает события об операциях всем подключённым клиентам по WebSocket.
3. Демонстрирует ваш подход к архитектуре, стилю кода и его эффективности.

### Несогласие с необходимостью REST API CRUD

Текущая реализация модуля предусматривает только сокетное взаимодействие, 
при этом сервис для работы с БД может быть подключенным в REST контроллер.

Такой подход более подходит для реализации бизнес-задачи, потому что:
1. **Cнижение round-trip задержек.** В текущей реализации клиент сам может сгенерировать 
UUID стикера и передать в сокет, благодаря этому UI не должен дожидаться создания стикера для того, 
чтобы пересобрать стейт. 
2. **Точка роста бизнеса.** Это расширяет бизнес-возможности - возможна простая реализация оффлайн создания 
стикера при потере соединения и отправке батч-запроса при его возобновлении
3. **Производительность.** Операции стремительно частые и REST может не справляться с частотой, а WS как раз создан для
частого общения клиентов в real-time между собой
4. **Поддержка.** Поддерживать один гейтвей значительно проще, чем гейтвей с прикрученным сверху REST контроллером
5. **Взаимодействие.** В случае с контроллером и гейтвеем в UI придется создавать в одном компоненте два инстанса
запросов - HTTP и WS. Поддерживать одно соединение со всем необходимым функционалом  значительно проще.

# Дорожная карта

- Глобальные модули переделать на forFeature / forRoot, чтобы импортировать просто сервис через DI
- Завернуть приложение в докер, чтобы запускать все в один тык

# Запуск

### События

Входящие события:
- join_board
- create_sticker
- update_sticker
- delete_sticker

Исходящие события:
- board_state
- sticker_created
- sticker_updated
- sticker_deleted

### Настроить .env

.env.example уже содержит нужные значения в рамках тестового задания, нужно переименовать в .env

### Запуск БД и Кафки

```shell
docker-compose up -d
```

### Вкатить миграцию

```shell
npm run db:migrate
```

### Установка зависимостей

```shell
npm install
```

### Запуск приложения

```shell
npm run start:dev
```
